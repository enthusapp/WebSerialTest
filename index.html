<title>WebSerialTest</title>
<head></head>
<body>
  <input type="button" value="test" id="test"/>
</body>
<script>
  const test = async () => {
    const port = await navigator.serial.requestPort({});
    console.log(port);
  };
  document.getElementById('test').addEventListener('click', () => {
      navigator.usb.requestDevice({filters: [{ 'vendorId': 0x10c4, 'productId': 0xea60 }]}).then(usb => {
        console.log(usb);
        usb.open()
          .then(() => {
            console.log(usb)
            return usb.reset();
          })
          .then(() => {
            console.log(usb)
            return usb.selectConfiguration(1)
          })
          .then(() => {
            console.log(usb)
            return usb.claimInterface(0)
          })
          .then(() => {
            console.log(usb)
            return usb.controlTransferOut({
              requestType: 'vendor',
              recipient: 'device',
              request: 0x00,
              index: 0x00,
              value: 0x01
            })
          })
          .then(() => {
            console.log(usb)
            return usb.controlTransferOut({
              requestType: 'vendor',
              recipient: 'device',
              request: 0x07,
              index: 0x00,
              value: 0x03 | 0x0100 | 0x0200
            })
          })
          .then(() => {
            console.log(usb)
            return usb.controlTransferOut({
              requestType: 'vendor',
              recipient: 'device',
              request: 0x01,
              index: 0x00,
              value: 0x384000 / 115200
            })
          })
          .then(async () => {
            const r = await usb.transferIn(1, 64)
            console.log(new Uint8Array(r.data.buffer));
          });
      }
      );
  });
</script>
